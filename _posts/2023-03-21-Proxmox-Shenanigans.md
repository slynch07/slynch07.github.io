---
layout: post
title:  "Proxmox Shenanigans"
date:   2023-03-21 14:32:15 -0500
categories: tech
---
It has been a minute since my last post and I‚Äôve been keeping busy with a handful of projects that have settled down some now.

I mentioned in my previous homelab post that I had installed Windows Server on a computer I picked up for learning and experimenting with. The rough plan after finishing Network+ was to install a bare-metal hypervisor and then reinstall Windows Server as a VM along with a few other operating systems for experimentation. When I had done my brief initial research the homelab hypervisor of choice seemed to be Proxmox so I figured I‚Äôd give that a shot.

Before I installed Proxmox I wanted to pick up a spare monitor that could live alongside the homelab for configuration and troubleshooting. I mentioned this to my wife when out to dinner after passing the Net+ cert and she graciously found a nice $20 unit on Facebook Marketplace close to where she works downtown and picked it up for me the next day. I had to hold off another day because it ended up being VGA only and by some miracle I had no spare VGA cables of any kind in the ol‚Äô spare cable box. Amazon had a very reasonably priced HDMI to VGA cable which seemed more likely to be useful long term so I ordered one of those and it came late the next day. After moving some things around I went to install Proxmox intending to have it ready for the first thing next day.

Unfortunately it wasn‚Äôt quite that straightforward. Back when I made the flash drive with the Windows Server 2022 partition I also made partitions with Proxmox and Ubuntu as well, intending to keep it as a multi use thumb drive. I was able to install Proxmox to the lab computer, but after the first reboot the boot process immediately halted. Apparently Debian doesn‚Äôt have secure boot support and since Proxmox is based on Debian I needed to disable that in BIOS. Once that was fixed I rebooted again and this time got a GRUB error saying ‚Äúunknown filesystem‚Äù 9 times and then resolving to the GRUB rescue shell. Based off of what I was able to gather online this was likely caused by me copying the Proxmox ISO to the USB drive partition using PowerShell. I‚Äôm not sure why it gives the specific error ‚Äúunknown filesystem‚Äù, the USB media was formatted fat32 and Proxmox itself formatted the internal flash drive during install, but apparently certain live ISO install programs will misconfigure something with UEFI creating issues with booting and [if you use Copy-Item from PowerShell like you would for a Windows Server iso drive](https://devblogs.microsoft.com/scripting/use-powershell-to-create-a-bootable-usb-drive/) that‚Äôll do it. ü§∑‚Äç‚ôÇÔ∏è

I tried poking around the GRUB shell briefly but being unfamiliar with how Linux works at that low level I was hesitant to dig in too far. I looked online and found this [guide](https://phoenixnap.com/kb/grub-rescue#ftoc-heading-5) using a tool called boot-repair, and I had the Ubuntu desktop live boot partition on the thumb drive already so I started booting that up. I got cold feet at first thinking I would have to dive in to GRUB configuration more than I wanted, I should‚Äôve just went and tried boot-repair first but I had it in my mind that if I installed Ubuntu fresh that it should overwrite/update GRUB during the install process and hopefully that would fix the boot loader. Then I could re-install Proxmox and be in business. I tried it, installed Ubuntu and went to reboot and this time got a different GRUB error, I think most of the difference being that Ubuntu had installed a newer version of GRUB. At this point it was getting late so I rebooted back into the Ubuntu live boot, installed boot-repair, fired it up, did the recommended repair, then shutdown the computer and held my breath. And it worked! Since I had the trouble with the first Proxmox install I then went and followed the recommended process I found while troubleshooting: downloading Etcher and using that to the Proxmox ISO onto the USB drive. Unfortunately (as far as I could tell at a quick glance) Etcher doesn‚Äôt allow you to flash to a specific partition which meant formatting over the Windows Server, existing Proxmox, and Ubuntu install partitions I had on the drive but it was getting late at this point and I didn‚Äôt want to risk the same thing happening.

I reinstalled Proxmox and booted right up correctly. I logged into the web configuration portal and checked it out for a moment but at this point it was getting late so I called it a night. Since then I‚Äôve installed a couple Ubuntu server VMs (as part of the wonderful [Learn Linux Proxmox Guide](https://www.youtube.com/playlist?list=PLT98CRl2KxKHnlbYhtABg6cF50bYa8Ulo)), the Windows Server VM (for the Active Directory Practice), a Windows 10 VM (to connect to the AD server VM), and Kali Linux (for certain exercises in TryHackMe). I was also able to configure the base computer to ‚ÄòWake on Lan‚Äô following along with [this guide](https://i12bretro.github.io/tutorials/0608.html), which is nice because now I can turn off the lab when I‚Äôm not using it and turn it on from anywhere on the local network without having physically run downstairs and hit the power button.

I‚Äôm about a week behind on what I‚Äôve been up to, but since all this I worked through the first half of [Learn Active Directory in a Month of Lunches](https://www.amazon.com/Learn-Active-Directory-Management-Lunches/dp/1617291196), did some minor updates to the blog (added a favicon, enabled emojis üëç, did some minor customization with the font + colors), and have been diving more into learning to work from the command line and doing some of the entry level paths in TryHackMe. The past week or so I‚Äôve been putting in applications and this week have a few interviews scheduled so hopefully that all goes well!